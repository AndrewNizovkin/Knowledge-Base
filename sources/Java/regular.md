# Регулярные выражения

# 18.1. Краткое введение в регулярные выражения

Выражение -- это строка символов. Символы, которые имеют особое назначение, называются *метасимволами*. Так, например, кавычки могут выделять прямую речь, т.е. быть *метасимволами* для строки, заключенной в эти кавычки. Регулярные выражения -- это набор символов и/или метасимволов, которые наделены особыми свойствами. [[1]](https://www.opennet.ru/docs/RUS/bash_scripting_guide/c11895.html#FTN.AEN11909)

Основное назначение регулярных выражений -- это поиск текста по шаблону и работа со строками.

- Звездочка `*` -- означает любое количество символов в строке, предшествующих "звездочке", *в том числе и нулевое число символов*.
    
    Выражение `1133*` -- означает *11 + один или более символов "3" + любые другие символы*: *113*, *1133*, *113312*, и так далее.
    
- Точка `.` означает не менее одного любого символа, за исключением символа перевода строки (\n). [[2]](https://www.opennet.ru/docs/RUS/bash_scripting_guide/c11895.html#FTN.AEN11937)
    
    Выражение "13." будет означать *13 + по меньшей мере один любой символ (включая пробел)*: *1133*, *11333*, но не *13* (отсутствуют дополнительные символы).
    
- Символ `^` означает начало строки, но иногда, в зависимости от контекста, означает отрицание в регулярных выражениях.
    
- Знак доллара `$` в конце регулярного выражения соответствует концу строки.
    
    Выражение "^$" соответствует пустой строке.
    
- Выражение `\W+` означает любую последовательность символов, которые не являются частью слова.
    
    
- Квадратные скобки `[...]` предназначены для задания подмножества символов. Квадратные скобки, внутри регулярного выражения, считаются одним символом, который может принимать значения, перечисленные внутри этих скобок..
    
    Выражение "[xyz]" -- соответствует одному из символов *x*, *y* или *z*.
    
    Выражение "[c-n]" соответствует одному из символов в диапазоне от *c* до *n*, включительно.
    
    Выражение "[B-Pk-y]" соответствует одному из символов в диапазоне от *B* до *P* или в диапазоне от *k* до *y*, включительно.
    
    Выражение "[a-z0-9]" соответствует одному из символов латиницы в нижнем регистре или цифре.
    
    Выражение "[^b-d]" соответствует любому символу, кроме символов из диапазона от *b* до *d*, включительно. В данном случае, метасимвол ^ означает отрицание.
    
    Объединяя квадратные скобки в одну последовательность, можно задать шаблон искомого слова. Так, выражение "[Yy][Ee][Ss]" соответствует словам *yes*, *Yes*, *YES*, *yEs* и так далее. Выражение "[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]" определяет шаблон для поиска любого номера карточки социального страхования (для США).
    
- Обратный слэш `\` служит для [экранирования](https://www.opennet.ru/docs/RUS/bash_scripting_guide/c1833.html#ESCP) специальных символов, это означает, что экранированные символы должны интерпретироваться буквально, т.е. как простые символы.
    
    Комбинация "\$" указывает на то, что символ "$" трактуется как обычный символ, а не как признак конца строки в регулярных выражениях. Аналогично, комбинация "\\" соответствует простому символу "\".
    
    
- Экранированные угловые скобки `\<...\>` отмечают границы слова.
    
    Угловые скобки должны экранироваться, иначе они будут интерпретироваться как простые символы.
    
    Выражение "\<the\>" соответствует слову "the", и не соответствует словам "them", "there", "other" и т.п.
    
    ```
    bash$cat textfileThis is line 1, of which there is only one instance.
    This is the only instance of line 2.
    This is line 3, another line.
    This is line 4.bash$grep 'the' textfileThis is line 1, of which there is only one instance.
    This is the only instance of line 2.
    This is line 3, another line.bash$grep '\<the\>' textfileThis is the only instance of line 2.
    
    ```
    
 **Дополнительные метасимволы.** Использующиеся при работе с 

   - [egrep](https://www.opennet.ru/docs/RUS/bash_scripting_guide/x7050.html#EGREPREF)

   - [awk](https://www.opennet.ru/docs/RUS/bash_scripting_guide/x14802.html#AWKREF)

   - [Perl](https://www.opennet.ru/docs/RUS/bash_scripting_guide/x13541.html#PERLREF) 
    
Знак вопроса `?` означает, что предыдущий символ или регулярное выражение встречается 0 или 1 раз. В основном используется для поиска одиночных символов.
    
    
Знак `+` указывает на то, что предыдущий символ или выражение встречается 1 или более раз. Играет ту же роль, что и символ "звездочка" (*), за исключением случая нулевого количества вхождений.
    
    ```
    # GNU версии sed и awk допускают использование "+",
    # но его необходимо экранировать.
    
    echo a111b | sed -ne '/a1\+b/p'
    echo a111b | grep 'a1\+b'
    echo a111b | gawk '/a1+b/'
    # Все три варианта эквивалентны.
    
    # Спасибо S.C.
    
    ```
    
- [Экранированные](https://www.opennet.ru/docs/RUS/bash_scripting_guide/c1833.html#ESCP) фигурные скобки `\{ \}` задают число вхождений предыдущего выражения.
    
    Экранирование фигурных скобок -- обязательное условие, иначе они будут интерпретироваться как простые символы. Такой порядок использования, технически, не является частью основного набора правил построения регулярных выражений.
    
    Выражение "[0-9]\{5\}" -- в точности соответствует подстроке из пяти десятичных цифр (символов из диапазона от 0 до 9, включительно).
    
    В "классической" (не совместимой с POSIX) версии [awk](https://www.opennet.ru/docs/RUS/bash_scripting_guide/x14802.html#AWKREF), фигурные скобки не могут быть использованы. Однако, в **gawk** предусмотрен ключ --re-interval, который позволяет использовать (неэкранированные) фигурные скобки.
    
    `bash$ **echo 2222 | gawk --re-interval '/2{3}/'**2222`